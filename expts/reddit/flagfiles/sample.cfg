--mode=fit
--framework=custom
--results_filename=results.txt
--fit_verbosity=2
--save_freq=50000
--monitor=MRR
--num_cpu=8
--num_classes=120601
--episode_len=16
--samples_per_class=4
--embedding_dim=512
--num_epochs=20
--steps_per_epoch=10000
--valid_steps=100
--num_queries=25000
--optimizer=sgd
--learning_rate=0.05
--first_decay_steps=10000
--weight_decay=0.0001
--schedule=piecewise
--momentum=0.9
--nonesterov
--grad_norm_clip=1.0
--batch_size=512
--features=syms+action_type+hour
--loss=triplet
--scale=64.0
--margin=0.2
--final_activation=relu
--num_filters=256
--min_filter_width=2
--max_filter_width=5
--filter_activation=relu
--num_layers=2
--d_model=512
--num_heads=4
--model_type=REG
--dff=256
--log_steps=1000
--dropout_rate=0.1
--subword_embed_dim=256
--action_embed_dim=256
--expt_config_path=/exp/akhan/id/expts/reddit/reddit.json
--num_parallel_readers=4
--shuffle_seed=42
--shuffle_buffer_size=8192
--distance=cosine
--train_tfrecord_path=/expscratch/nandrews/aleem/reddit/train/queries*.tf
--valid_tfrecord_path=/expscratch/nandrews/aleem/reddit/train/targets*.tf
